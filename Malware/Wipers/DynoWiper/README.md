# Malware Profile — DynoWiper & RTU Firmware Wiper

![TLP:WHITE](https://img.shields.io/badge/TLP-WHITE-white)
![Type](https://img.shields.io/badge/Type-Wiper-red)
![Platform](https://img.shields.io/badge/Platform-Windows_%7C_ELF_(RTU)-blue)

| Field | Value |
|-------|-------|
| **Malware Family** | DynoWiper (HMI) + RTU Firmware Wiper |
| **Type** | Destructive Wiper |
| **Operator** | DragonFly / Ghost Blizzard (FSB Center 16) |
| **First Seen** | 2025-12-29 |
| **Targets** | ICS/SCADA — HMI systems, Remote Terminal Units (RTUs) |
| **Deployment** | GPO "Default Domain Policy" modification + Scheduled Tasks |
| **Campaign** | [Polish Grid Attack (Dec 2025)](../../../APT-Groups/DragonFly-GhostBlizzard/Campaigns/2025-12_PolishGrid/) |

---

## DynoWiper (HMI Wiper)

Windows PE binary designed to destroy data on Human-Machine Interface (HMI) systems in electrical grid environments.

### Technical Characteristics

| Property | Detail |
|----------|--------|
| **File Size** | < 500 KB |
| **Signing** | Unsigned (no Microsoft signature) |
| **PRNG Engine** | Mersenne Twister (MT19937) |
| **Overwrite Method** | PRNG-generated random data overwrites file contents |
| **Distribution** | GPO modification ("Default Domain Policy") + scheduled tasks |

### Execution Flow

```
DynoWiper.exe
├── GetLogicalDrives()       → enumerate all disk volumes
├── FindFirstFileW/NextFileW → recursive file iteration
├── SetFileAttributesW()     → remove read-only / hidden / system
├── MT19937 PRNG init        → generate pseudo-random overwrite data
├── Overwrite file contents   → destroy original data
└── DeleteFileW()            → remove overwritten files
```

### MT19937 Constants (YARA signatures)

| Constant | Hex Bytes | Purpose |
|----------|-----------|---------|
| MT init multiplier | `65 89 07 6C` | Mersenne Twister initialization |
| MT twist constant | `DF B0 08 99` | Tempering/twisting step |
| Upper mask | `FF FF FF 7F` | 0x7FFFFFFF — bit masking |

---

## RTU Firmware Wiper

Corrupted ELF binary deployed to Remote Terminal Units to render field devices permanently inoperable.

### Technical Characteristics

| Property | Detail |
|----------|--------|
| **Format** | ELF binary |
| **Mechanism** | Entry point filled entirely with `0xFF` bytes |
| **Effect** | Firmware nonfunctional — device bricked |
| **Target** | RTU devices controlling electrical grid segments |

### Detection Logic

```
ELF magic (0x7f454c46) present
  └── Entry point: 64+ consecutive 0xFF bytes
        └── MALICIOUS — no legitimate firmware has this pattern
```

---

## Distribution Method

Both wipers were distributed within the compromised domain through:

1. **GPO Modification** — "Default Domain Policy" altered to deploy wiper to all domain-joined HMI systems
2. **Scheduled Tasks** — created via remote execution for time-coordinated detonation
3. **SMB Lateral Movement** — admin shares enabled via PowerShell, firewall rule "Microsoft Update" added for port 445

---

## YARA Rules

| Rule | Target | FP Rate |
|------|--------|---------|
| [dynowiper_mersenne.yar](yara/dynowiper_mersenne.yar) | DynoWiper PE with MT19937 constants + wiper imports | < 1 / 100,000 |
| [elf_rtu_wiper.yar](yara/elf_rtu_wiper.yar) | ELF with 0xFF-only entry point | Extremely low |

---

## IOCs

| Type | Value | Description |
|------|-------|-------------|
| SHA256 | `60c70cdcb1e998bffed2e6e7298e1ab6bb3d90df04e437486c04e77c411cae4b` | DynoWiper sample 1 |
| SHA256 | `835b0d87ed2d49899ab6f9479cddb8b4e03f5aeb2365c50a51f9088dcede68d5` | DynoWiper sample 2 |
| SHA256 | `65099f306d27c8bcdd7ba3062c012d2471812ec5e06678096394b238210f0f7c` | DynoWiper sample 3 |
| SHA256 | `d1389a1ff652f8ca5576f10e9fa2bf8e8398699ddfc87ddd3e26adb201242160` | DynoWiper sample 4 |

Full IOC list: [iocs.csv](iocs.csv)

---

## References

| Source | URL |
|--------|-----|
| Truesec | [Detecting Russian Threats to Critical Energy Infrastructure](https://www.truesec.com/hub/blog/detecting-russian-threats-to-critical-energy-infrastructure) |
| CERT.PL | [Energy Sector Incident Report 2025](https://cert.pl/uploads/docs/CERT_Polska_Energy_Sector_Incident_Report_2025.pdf) |
| Parent Actor | [DragonFly / Ghost Blizzard](../../../APT-Groups/DragonFly-GhostBlizzard/) |
