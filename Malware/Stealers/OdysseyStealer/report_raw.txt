================================================================================
                  ODYSSEY STEALER - TANITIM & IOC'LER
================================================================================

################################################################################
                              BÖLÜM 1: TANITIM
################################################################################

================================================================================
1. GENEL BAKIŞ
================================================================================

Odyssey Stealer, macOS'u hedef alan, kripto hırsızlığına odaklanan bir 
stealer/RAT aracıdır. Poseidon Stealer'ın rebrand'idir ve Poseidon da 
Atomic macOS Stealer (AMOS) projesinden fork edilmiştir.

Soy Zinciri: AMOS → Poseidon → Odyssey

Temel Özellikler:
  - 203 kripto cüzdan uzantısı hedefleme
  - 18 masaüstü cüzdan hedefleme
  - Trojanize edilmiş Ledger/Trezor uygulama değiştirme
  - RAT döngüsü ile SOCKS5 proxy desteği
  - Affiliate (ortaklık) modeli ile ticari operasyon

================================================================================
2. SALDIRI ZİNCİRİ
================================================================================

1. Sosyal mühendislik: Kurban kötü niyetli bir bağlantıya tıklar (phishing, 
   malvertising vb.)
2. Payload indirme: Tarayıcı C2'den .sh veya .app dropper'ı indirir
3. AppleScript çalıştırma: Obfüske AppleScript payload çalışır
4. Parola çalma: Sahte dialog kullanıcıyı macOS parolasını girmeye kandırır
5. Veri toplama: Tarayıcı verileri, kripto cüzdanlar, Keychain, Notes ve 
   dosyalar toplanır
6. ZIP exfiltration: Veriler sıkıştırılıp /log endpoint'ine POST ile C2'ye 
   gönderilir
7. Uygulama değiştirme: Meşru Ledger/Trezor uygulamaları trojanize 
   versiyonlarla değiştirilir
8. Kalıcılık kurulumu: LaunchDaemon ile kalıcı erişim sağlanır
9. RAT döngüsü: Backdoor her 60 saniyede C2'yi kontrol eder 
   (repeat, doshell, enablesocks5, uninstall)

================================================================================
3. PAYLOAD MİMARİSİ
================================================================================

Aşama 1 - İlk Dropper:
  - Obfüske AppleScript, shell script içine sarılmış
  - Obfüskasyon: iç içe "run script" wrapper'ları, string birleştirme
  - Numerik tanımlayıcılar, string birleştirme, çoklu escape edilmiş tırnaklar
  - Hardcoded yapılandırma: affiliate kullanıcı adı, C2 sunucu, repeat bayrağı
  - Sahte parola dialogu (dscl . authonly ile doğrulama)

Aşama 2 - Kalıcılık Payload:
  - Minimal RAT, LaunchDaemon olarak kurulur
  - C2 adresini diskten okur (hardcode değil → statik analiz C2 URL'sini bulamaz)
  - Komutlar: repeat, doshell, enablesocks5, uninstall
  - Her 60 saniyede C2'yi yoklar

Aşama 3 - SOCKS5 Proxy:
  - Go ile derlenmiş universal Mach-O binary
  - yamux kütüphanesi ile bağlantı havuzu
  - Tüm C2 sunucularında aynı hash (merkezi build)

================================================================================
4. YETENEKLERİ
================================================================================

Veri Hırsızlığı:
  Chromium Tabanlı Tarayıcılar:
    - Chrome, Brave, Edge, Vivaldi, Opera, OperaGX, Arc, CocCoc
    - Çerezler, kayıtlı parolalar (Login Data), form verileri (Web Data)
    - Kripto cüzdan uzantı verileri (Local Extension Settings, IndexedDB)

  Gecko Tabanlı Tarayıcılar:
    - Firefox, Waterfox
    - cookies.sqlite, logins.json, key4.db, formhistory.sqlite
    - Firefox profillerinden MetaMask uzantı verileri

  Kripto Cüzdan Uzantıları (203 hedef):
    - nkbihfbeogaeaoehlefnkodbefgpgknn → MetaMask
    - bfnaelmomeimhlpmgjnjophhpkkoljpa → Phantom
    - hnfanknocfeofbddgcijnmhnfnkdnaad → Coinbase Wallet
    - ibnejdfjmmkpcnlpebklmnkoeoihofec → TronLink
    - fnjhmkhhmkbjkkabndcnnogagogbneec → Ronin Wallet

  Masaüstü Cüzdanlar (18 hedef):
    - Electrum          → ~/.electrum/wallets/
    - Exodus            → ~/Library/Application Support/Exodus/
    - Atomic            → ~/Library/Application Support/atomic/Local Storage/leveldb/
    - Ledger Live       → ~/Library/Application Support/Ledger Live/
    - Trezor Suite      → ~/Library/Application Support/@trezor/suite-desktop/
    - Bitcoin Core      → ~/Library/Application Support/Bitcoin/wallets/
    - Monero            → ~/Monero/wallets/
    - Wasabi            → ~/.walletwasabi/client/Wallets/
    - Sparrow           → ~/.sparrow/wallets/

  Diğer Veriler:
    - Apple Notes → NoteStore.sqlite veritabanı ve medya ekleri
    - Safari → Çerezler, form otomatik doldurma verileri
    - Keychain → Tam Keychain veritabanı (login.keychain-db)
    - Telegram → Telegram Desktop oturum verileri
    - Desktop/Documents → Yapılandırılmış uzantılara uyan dosyalar (10MB'a kadar)

C2 Protokolü:
  Endpoint                           | Metod | Amaç
  -----------------------------------+-------+---------------------------
  /d/{affiliate}{digits}             | GET   | Payload dağıtımı
  /log                               | POST  | Veri exfiltration
  /api/v1/bot/joinsystem/{user}/{os} | GET   | Bot kaydı
  /api/v1/bot/actions/{botid}        | GET   | Komut yoklama
  /api/v1/bot/repeat/{user}          | GET   | Yeniden enfeksiyon scripti
  /otherassets/{file}                | GET   | Trojanize uygulamalar, SOCKS proxy

RAT Komutları:
  Komut         | Eylem
  --------------+------------------------------------------------------------
  repeat        | /api/v1/bot/repeat/{username} scriptini indirir ve çalıştırır
  doshell       | Keyfi shell komutu çalıştırır
  enablesocks5  | SOCKS5 proxy indirir ve çalıştırır
  uninstall     | ~/.uninstalled yazar ve çıkar

================================================================================
5. SOY ZİNCİRİ: AMOS → POSEIDON → ODYSSEY
================================================================================

Geliştirici: Rodrigo4 (XSS forumu)

Zaman Çizelgesi:
  Orta 2023  → Rodrigo, Ping3r liderliğinde AMOS üzerinde çalışır
  Eyl 2023   → XSS'de $3.000/ay, 15 slot olarak reklam
  Erken 2024 → Rodrigo AMOS'tan ayrılır (kaynak kodunu aldığı iddia ediliyor)
  Mar 2024   → XSS'de halka açık kavga (Ping3r şantaj ve karalama suçlaması)
  Orta 2024  → Rodrigo, Poseidon Stealer'ı rakip MaaS ürünü olarak başlatır
  Ağu 2024   → Rodrigo platformu bilinmeyen bir alıcıya satar ve çıkar
  Orta 2025  → Yeni operatörler Poseidon'u Odyssey Stealer olarak yeniden markalar

Kod Örtüşmeleri:
  - AppleScript tabanlı dağıtım (AMOS'tan miras)
  - Tarayıcı hedefleme (üç ailede neredeyse aynı path listeleri)
  - Cüzdan uzantı hedefleme (aynı uzantı ID listeleri)
  - Keychain hırsızlığı (aynı Chrome master password çıkarma tekniği)
  - LaunchDaemon kalıcılığı (benzer plist yapısı)
  - Trojanize uygulamalar (Poseidon ile paylaşılan Ledger/Trezor değiştirme kalıbı)

================================================================================
6. ATRİBÜSYON İPUÇLARI
================================================================================

Rusça konuşan geliştiricilere işaret eden göstergeler:
  1. XSS forum varlığı → Rodrigo4 Rusça siber suç forumunda faaliyet gösterdi
  2. Dashboard çevirileri → Admin paneli İngilizce ve Rusça içerir
  3. Değişken isimlendirme → "xxxblyat" build ID'si Rusça bir küfüre referans
  4. Forum reklamları → Tamamen Rusça yayınlanmış

Mevcut operatörler bilinmiyor (Rodrigo Ağustos 2024'te platformu sattı).

================================================================================
7. TESPİT VE ÖNLEMLERİ
================================================================================

  1. Garip osascript kullanımını izleyin → Uzun base64 veya obfüske komutlar
  2. LaunchDaemon'ları kontrol edin → com.{rastgele-sayılar} kalıpları
  3. Ağ izleme → C2 domain/IP'lerini engelleyin, /log endpoint'ine POST izleyin
  4. Uygulama imzalarını doğrulayın → Ledger Live/Trezor Suite imza kontrolü
  5. Kullanıcı eğitimi → Uygulama kurulumlarında parola isteklerine şüpheyle yaklaşma


################################################################################
                             BÖLÜM 2: IOC'LER
################################################################################

================================================================================
AĞ GÖSTERGELERİ (NETWORK INDICATORS)
================================================================================

C2 Sunucuları:
  213.209.159[.]175
  62.60.131[.]230
  62.60.131[.]250
  5.199.166[.]102
  77.90.185[.]24
  185.11.61[.]84
  217.119.139[.]117
  185.93.89[.]62
  185.93.89[.]63
  45.146.130[.]129

C2 Domain'leri:
  charge0x[.]at
  something0x[.]at
  sdojifsfiudgigfiv[.]to

API Endpoint'leri:
  /d/{affiliate}{digits}
  /log
  /api/v1/bot/joinsystem/
  /api/v1/bot/actions/
  /api/v1/bot/repeat/
  /otherassets/

================================================================================
DOSYA GÖSTERGELERİ (FILE INDICATORS)
================================================================================

Trojanize Uygulamalar - Küme A (62.60.131[.]230, something0x[.]at):

  Dosya                     | SHA256
  --------------------------+------------------------------------------------------------------
  ledger.zip                | 9717c436a934c556b2dae87e0ce269e22dd10e1099f38b9c9d0cba47a7f9bcb8
  ledgerwallet.zip          | 1cd1e1a990430d6f968f3e99bffc30707f2dbe7936ca48a71710797adbf3e97e
  trezor.zip                | 09147da1add9608480db279bb7e1db59ed9e1b8360ead2fab53eb4ce03fa1dcc
  Ledger Live (executable)  | 493e0c4ad909df1755bb62ebc4b6491d827d8ed381d1468fc15accd3191cb398
  Ledger Wallet (executable)| 714843b753bf2e01f5bac14614f3c63b17ec922e3026326208ee5d7d741b1a2b
  Trezor Suite (executable) | c785aa21c2165b8b13bdad4f015213f821b60658e276eb78dfbbfaf116753c82

Trojanize Uygulamalar - Küme B (62.60.131[.]250, charge0x[.]at):

  Dosya                     | SHA256
  --------------------------+------------------------------------------------------------------
  ledger.zip                | 71a065da58455e0fab8ecef1ee4f8a94d93cd9af440f66f81976870ca86f3f82
  ledgerwallet.zip          | 47a3118defd96dbb729a42df5d7359db672a083c553be56b47551a56f8b04088
  trezor.zip                | 593f92db40e06da10823bdb2dad4b7ae23eee2a68d943496704bdd81add0ba5f
  Ledger Live (executable)  | e4aa990fdc7f074e765c2c4dde55c812d5f23f53acda9dc1fe1fb2359bcf37bf
  Ledger Wallet (executable)| 6c31b4a6bf623f7d9a213a808cfe821a6b4175333f4dac045530c61ffd3b8dcf
  Trezor Suite (executable) | 77265bc63326115cbb165ee08b686720155c4065ab93494cba1816c5ca8a2d2d

Paylaşılan Binary (tüm sunucularda aynı):

  Dosya  | SHA256
  -------+------------------------------------------------------------------
  socks  | d254125912d9e9e5c271766bc4f6eea0c296ad2c0cf19d4bd57081d1bf10f044

================================================================================
BUILD ID'LERİ
================================================================================

  af2ddda1708144e998153bc0e916b77f    → roberto
  xxxblyat                            → admin/test

================================================================================
AFFİLİATE KULLANICI ADLARI
================================================================================

  roberto   → Kampanyalar: roberto3403, roberto4603, roberto5446, roberto7031
  admin     → Test affiliate?

================================================================================
DAVRANIŞSAL GÖSTERGELER (BEHAVIORAL INDICATORS)
================================================================================

Dosya Yolları:
  ~/.botid
  ~/.chost
  ~/.pwd
  ~/.username
  ~/.lastaction
  ~/.uninstalled
  /Library/LaunchDaemons/com.{5-haneli-sayı}.plist

Süreç Kalıpları:
  - osascript ile uzun encoded komutlar çalıştırma
  - curl ile buildid ve username header'ları kullanma
  - Rastgele com.{sayı} etiketli LaunchDaemon
