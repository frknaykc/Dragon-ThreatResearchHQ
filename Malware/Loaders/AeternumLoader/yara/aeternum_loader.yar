rule Aeternum_Loader_Panel {
    meta:
        description = "Detects Aeternum Loader C2 Panel"
        author = "C2-Hunting"
        date = "2026-02-17"
        reference = "https://ctrlaltintel.com/threat%20research/Aeternum-Part-1/"
    
    strings:
        $html1 = "Panel Blockchain C2 BotNet" ascii
        $html2 = "Aeternum C2 BotNet" ascii
        $html3 = "Smart Contract BotNet Panel" ascii
        $rpc1 = "polygon-rpc.com" ascii
        $auth1 = "Connect Wallet" ascii
        $auth2 = "Use your private key" ascii
        $ssl1 = "DESKTOP-L3QJT6H" ascii
    
    condition:
        (3 of ($html*)) or
        (2 of ($html*) and 1 of ($rpc*)) or
        ($ssl1 and 1 of ($html*))
}

rule Aeternum_Loader_Malware {
    meta:
        description = "Detects Aeternum Loader malware binary patterns"
        author = "C2-Hunting"
        date = "2026-02-17"
    
    strings:
        $poly_rpc1 = "polygon-rpc.com" ascii
        $poly_rpc2 = "rpc-mainnet.maticvigil.com" ascii
        $poly_rpc3 = "matic-mainnet.chainstacklabs.com" ascii
        $poly_rpc4 = "polygon-mainnet.public.blastapi.io" ascii
        $func1 = "getDomain" ascii
        $func2 = "updateDomain" ascii
        $aes = "AES-GCM" ascii
        $pbkdf = "PBKDF2" ascii
        $cmd1 = "hwid:" ascii
        $cmd2 = "all:url:" ascii
        $cmd3 = "savestartupname:" ascii
    
    condition:
        (3 of ($poly_rpc*)) or
        (2 of ($func*) and ($aes or $pbkdf)) or
        (2 of ($cmd*))
}
